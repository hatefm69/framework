DECLARE
V_COUNT INTEGER;
BEGIN
SELECT COUNT(TABLE_NAME) INTO V_COUNT from USER_TABLES where TABLE_NAME = 'EF_MIGRATION_HISTORY';
IF V_COUNT = 0 THEN
Begin
BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"EF_MIGRATION_HISTORY" (
    "MigrationId" NVARCHAR2(150) NOT NULL,
    "ProductVersion" NVARCHAR2(32) NOT NULL,
    CONSTRAINT "PK_EF_MIGRATION_HISTORY" PRIMARY KEY ("MigrationId")
)';
END;

End;

END IF;
EXCEPTION
WHEN OTHERS THEN
    IF(SQLCODE != -942)THEN
        RAISE;
    END IF;
END;
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"ERROR" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "EXCEPTION_DATA" NVARCHAR2(2000) NOT NULL,
    "EXTRA_DATA" NVARCHAR2(2000) NOT NULL,
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_ERROR" PRIMARY KEY ("ID")
)';
END;
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"INSPECTION_GROUP" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "TITLE" NVARCHAR2(256) NOT NULL,
    "IS_ACTIVE" NUMBER(1) NOT NULL,
    "DEACTIVATION_DATE" NUMBER(19),
    "DESCRIPTION" NVARCHAR2(256) NOT NULL,
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_INSPECTION_GROUP" PRIMARY KEY ("ID")
)';
END;
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"LOG" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "TABLE_NAME" NVARCHAR2(64) NOT NULL,
    "ACTION" NVARCHAR2(64) NOT NULL,
    "RECORD_DATA" NVARCHAR2(2000) NOT NULL,
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_LOG" PRIMARY KEY ("ID")
)';
END;
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251125100521_cmi-001', N'9.0.5')
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"BRANCH_DEGREE" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "NAME" NVARCHAR2(100) NOT NULL,
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_BRANCH_DEGREE" PRIMARY KEY ("ID")
)';
END;
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251126110700_cmi-002', N'9.0.5')
/

declare
   l_nullable user_tab_columns.nullable % type;
begin 
   select nullable into l_nullable 
   from user_tab_columns 
  where table_name = 'INSPECTION_GROUP' 
  and column_name = 'DESCRIPTION' 
;
   if l_nullable = 'N' then 
        EXECUTE IMMEDIATE 'ALTER TABLE "INSPECTION_GROUP" MODIFY "DESCRIPTION"  NULL';
 else 
        EXECUTE IMMEDIATE 'ALTER TABLE "INSPECTION_GROUP" MODIFY "DESCRIPTION" ';
 end if;
end;
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251129054316_cmi-002', N'9.0.5')
/

DROP TABLE "BRANCH_DEGREE"
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"BRANCH_INSPECTION_DAY_ALLOCATION" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "INSPECTION_DAY_NUMBER" NUMBER(5) NOT NULL,
    "IS_ACTIVE" NUMBER(1) NOT NULL,
    "DEACTIVATION_DATE" NUMBER(19),
    "BRANCH_DEGREE_ID" NUMBER(19) NOT NULL,
    "DESCRIPTION" NVARCHAR2(256) NOT NULL,
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_BRANCH_INSPECTION_DAY_ALLOCATION" PRIMARY KEY ("ID")
)';
END;
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251129065443_cmi-003', N'9.0.5')
/

declare
   l_nullable user_tab_columns.nullable % type;
begin 
   select nullable into l_nullable 
   from user_tab_columns 
  where table_name = 'BRANCH_INSPECTION_DAY_ALLOCATION' 
  and column_name = 'DESCRIPTION' 
;
   if l_nullable = 'N' then 
        EXECUTE IMMEDIATE 'ALTER TABLE "BRANCH_INSPECTION_DAY_ALLOCATION" MODIFY "DESCRIPTION"  NULL';
 else 
        EXECUTE IMMEDIATE 'ALTER TABLE "BRANCH_INSPECTION_DAY_ALLOCATION" MODIFY "DESCRIPTION" ';
 end if;
end;
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251130095116_cmi-004', N'9.0.5')
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"INSPECTION_SUB_GROUP" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "TITLE" NVARCHAR2(256) NOT NULL,
    "INSPECTION_GROUP_ID" NUMBER(19) NOT NULL,
    "IS_ACTIVE" NUMBER(1) NOT NULL,
    "DEACTIVATION_DATE" NUMBER(19),
    "DESCRIPTION" NVARCHAR2(256),
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_INSPECTION_SUB_GROUP" PRIMARY KEY ("ID"),
    CONSTRAINT "FK_INSPECTION_SUB_GROUP_INSPECTION_GROUP_INSPECTION_GROUP_ID" FOREIGN KEY ("INSPECTION_GROUP_ID") REFERENCES "INSPECTION_GROUP" ("ID")
)';
END;
/

CREATE INDEX "IX_INSPECTION_SUB_GROUP_INSPECTION_GROUP_ID" ON "INSPECTION_SUB_GROUP" ("INSPECTION_GROUP_ID")
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251130120405_cmi-005', N'9.0.5')
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"TEST_YEKE" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "BLACK" NVARCHAR2(2000) NOT NULL,
    "WHITE" VARCHAR2(4000) NOT NULL,
    "TICK" NVARCHAR2(2000) NOT NULL,
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_TEST_YEKE" PRIMARY KEY ("ID")
)';
END;
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251207051508_cmi-006', N'9.0.5')
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"INSPECTION_PERIOD" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "TITLE" NVARCHAR2(256) NOT NULL,
    "IS_ACTIVE" NUMBER(1) NOT NULL,
    "DEACTIVATION_DATE" NUMBER(19),
    "YEAR" NUMBER(5) NOT NULL,
    "FROM_DATE" NUMBER(19) NOT NULL,
    "TO_DATE" NUMBER(19) NOT NULL,
    "DESCRIPTION" NVARCHAR2(256),
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_INSPECTION_PERIOD" PRIMARY KEY ("ID")
)';
END;
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251207113028_cmi-007', N'9.0.5')
/

CREATE SEQUENCE "INSPECTION_TERM_CODE_SEQ" START WITH 1 INCREMENT BY 1 NOMINVALUE NOMAXVALUE NOCYCLE
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"INSPECTION_TERM" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "CODE" NUMBER(19) DEFAULT ("INSPECTION_TERM_CODE_SEQ".NEXTVAL) NOT NULL,
    "FROM_DATE" NUMBER(19) NOT NULL,
    "TO_DATE" NUMBER(19) NOT NULL,
    "IS_ACTIVE" NUMBER(1) DEFAULT 1,
    "DESCRIPTION" NCLOB,
    "YEAR" NUMBER(10) NOT NULL,
    "TITLE" NVARCHAR2(256) NOT NULL,
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_INSPECTION_TERM" PRIMARY KEY ("ID")
)';
END;
/

CREATE UNIQUE INDEX "IX_CODE" ON "INSPECTION_TERM" ("CODE")
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251209100407_cmi-008', N'9.0.5')
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"REFERRAL_GROUP" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "TITLE" NVARCHAR2(250) NOT NULL,
    "IS_ACTIVE" NUMBER(1) NOT NULL,
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_REFERRAL_GROUP" PRIMARY KEY ("ID")
)';
END;
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251209110317_cmi-009', N'9.0.5')
/

DROP TABLE "INSPECTION_TERM"
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251209110919_cmi-010', N'9.0.5')
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"Distance" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "FROM_UNIT" NVARCHAR2(10) NOT NULL,
    "TO_UNIT" NVARCHAR2(10) NOT NULL,
    "TO_REGION" NVARCHAR2(10) NOT NULL,
    "VALUE" NUMBER(19) NOT NULL,
    "IS_CONVERT" NUMBER(1) DEFAULT 0,
    "IS_ACTIVE" NUMBER(1) NOT NULL,
    "DEACTIVATION_DATE" NUMBER(19),
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_Distance" PRIMARY KEY ("ID")
)';
END;
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251209132603_cmi-011', N'9.0.5')
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"BRANCH_MANAGEMENT_TEAM_ALLOCATION" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "REFERRAL_GROUP_ID" NUMBER(19) NOT NULL,
    "INSPECTOR_REFERRAL_PROFILE_ID" NUMBER(19) NOT NULL,
    "IS_ACTIVE" NUMBER(1) NOT NULL,
    "DEACTIVATION_DATE" NUMBER(19),
    "REGION_CODE" NVARCHAR2(2000) NOT NULL,
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_BRANCH_MANAGEMENT_TEAM_ALLOCATION" PRIMARY KEY ("ID"),
    CONSTRAINT "FK_BRANCH_MANAGEMENT_TEAM_ALLOCATION_REFERRAL_GROUP_REFERRAL_GROUP_ID" FOREIGN KEY ("REFERRAL_GROUP_ID") REFERENCES "REFERRAL_GROUP" ("ID")
)';
END;
/

CREATE INDEX "IX_BRANCH_MANAGEMENT_TEAM_ALLOCATION_REFERRAL_GROUP_ID" ON "BRANCH_MANAGEMENT_TEAM_ALLOCATION" ("REFERRAL_GROUP_ID")
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251210082011_cmi-012', N'9.0.5')
/

ALTER TABLE "BRANCH_MANAGEMENT_TEAM_ALLOCATION" RENAME COLUMN "INSPECTOR_REFERRAL_PROFILE_ID" TO "INSPECTOR_PROFILE_ID"
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251210085402_cmi-013', N'9.0.5')
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"INSPECTOR_PROFILE" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "PERSONEL_CODE" NVARCHAR2(20) NOT NULL,
    "PROFILE_TYPE_ID" NUMBER(3) NOT NULL,
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_INSPECTOR_PROFILE" PRIMARY KEY ("ID")
)';
END;
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251210093336_cmi-014', N'9.0.5')
/

CREATE INDEX "IX_BRANCH_MANAGEMENT_TEAM_ALLOCATION_INSPECTOR_PROFILE_ID" ON "BRANCH_MANAGEMENT_TEAM_ALLOCATION" ("INSPECTOR_PROFILE_ID")
/

ALTER TABLE "BRANCH_MANAGEMENT_TEAM_ALLOCATION" ADD CONSTRAINT "FK_BRANCH_MANAGEMENT_TEAM_ALLOCATION_INSPECTOR_PROFILE_INSPECTOR_PROFILE_ID" FOREIGN KEY ("INSPECTOR_PROFILE_ID") REFERENCES "INSPECTOR_PROFILE" ("ID")
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251210094046_cmi-015', N'9.0.5')
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"INSPECTOR_PROFILE_REFERRAL_GROUP" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "INSPECTOR_PROFILE_ID" NUMBER(19) NOT NULL,
    "REFERRAL_GROUP_ID" NUMBER(19) NOT NULL,
    "IS_ACTIVE" NUMBER(1) NOT NULL,
    "DEACTIVATION_DATE" NUMBER(19),
    "DESCRIPTION" NVARCHAR2(256) NOT NULL,
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_INSPECTOR_PROFILE_REFERRAL_GROUP" PRIMARY KEY ("ID"),
    CONSTRAINT "FK_INSPECTOR_PROFILE_REFERRAL_GROUP_INSPECTOR_PROFILE_INSPECTOR_PROFILE_ID" FOREIGN KEY ("INSPECTOR_PROFILE_ID") REFERENCES "INSPECTOR_PROFILE" ("ID"),
    CONSTRAINT "FK_INSPECTOR_PROFILE_REFERRAL_GROUP_REFERRAL_GROUP_REFERRAL_GROUP_ID" FOREIGN KEY ("REFERRAL_GROUP_ID") REFERENCES "REFERRAL_GROUP" ("ID")
)';
END;
/

CREATE INDEX "IX_INSPECTOR_PROFILE_REFERRAL_GROUP_INSPECTOR_PROFILE_ID" ON "INSPECTOR_PROFILE_REFERRAL_GROUP" ("INSPECTOR_PROFILE_ID")
/

CREATE INDEX "IX_INSPECTOR_PROFILE_REFERRAL_GROUP_REFERRAL_GROUP_ID" ON "INSPECTOR_PROFILE_REFERRAL_GROUP" ("REFERRAL_GROUP_ID")
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251210114237_cmi-016', N'9.0.5')
/

declare
   l_nullable user_tab_columns.nullable % type;
begin 
   select nullable into l_nullable 
   from user_tab_columns 
  where table_name = 'INSPECTOR_PROFILE_REFERRAL_GROUP' 
  and column_name = 'DESCRIPTION' 
;
   if l_nullable = 'N' then 
        EXECUTE IMMEDIATE 'ALTER TABLE "INSPECTOR_PROFILE_REFERRAL_GROUP" MODIFY "DESCRIPTION"  NULL';
 else 
        EXECUTE IMMEDIATE 'ALTER TABLE "INSPECTOR_PROFILE_REFERRAL_GROUP" MODIFY "DESCRIPTION" ';
 end if;
end;
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251213074642_cmi-017', N'9.0.5')
/

BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"CALENDAR_SETTING" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "YEAR" NUMBER(10) NOT NULL,
    "SANA_ID" NUMBER(19) NOT NULL,
    "CREATED_AT" NUMBER(19) NOT NULL,
    "CREATED_BY" NVARCHAR2(64) NOT NULL,
    "CREATED_VIA" NVARCHAR2(15) NOT NULL,
    "LAST_EDITED_AT" NUMBER(19),
    "LAST_EDITED_VIA" NVARCHAR2(15),
    "LAST_EDITOR_BY" NVARCHAR2(64),
    CONSTRAINT "PK_CALENDAR_SETTING" PRIMARY KEY ("ID")
)';
END;
/

INSERT INTO "EF_MIGRATION_HISTORY" ("MigrationId", "ProductVersion")
VALUES (N'20251213093303_cmi-018', N'9.0.5')
/

